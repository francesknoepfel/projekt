{% include "header.jinja2" %} <!-- header einbinden -->
{% include "navbar.jinja2" %} <!-- navbar einbinden -->

<style>
    /* zeigt an nach was jetzt sortiert wurde */
    th.active {
        background-color: yellow;
    }
    .finished-task {
        text-decoration: line-through;
        color: gray;
    }
</style>

<div class="container">
    <h1 class="mt-5 display-4">Willkommen zu Tick Task!</h1>
    <p class="card-text text-muted">
        Mit Tick Task kannst du alle deine wichtigen Tasks und To-Dos festhalten und abhacken.
        Du kannst neue Einträge machen und diese Listen und Kategorien zuordnen.
        Wenn du den Tasks eine Priorität oder ein Datum zuordnest, siehst du auf einen Blick, was als nächstes ansteht.
        So kannst du über Chaos eine Übersicht haben.
    </p>

    <h3 class="mt-5 display-6">Task Übersicht</h3>
    <!-- Task Übersicht -->
    <p class="card-text text-muted"> Sobald du Tasks einträgst, werden sie hier angezeigt.</p>
    <table class="table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Deadline</th>
                <th>Priorität</th>
                <th>Kategorie</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks|sort(attribute='priority') %}
            <tr {% if task.finished %}class="finished-task"{% endif %}>
                <td>{{ task.name }}</td>
                <td>{{ task.deadline }}</td>
                <td>{{ task.priority }}</td>
                <td>{{ task.category }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% for category, data in category_data.items() %}
        <h2>{{ category }}</h2>
        <div class="task-list">
            {% for task in data['tasks'] %}
                <div class="task {% if task.finished %}finished{% endif %}">
                    <h3>{{ task.name }}</h3>
                    <p>Deadline: {{ task.deadline }}</p>
                     Display other task details

                   {% if not task.finished %}
                        <form action="/mark_task_finished" method="POST" style="display: inline;">
                            <input type="hidden" name="task_id" value="{{ loop.index0 }}">
                            <input type="submit" value="Mark as Finished">
                        </form>
                    {% else %}
                        <p>Dieser Task ist abgeschlossen</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% endfor %}
</div>

{% include "footer.jinja2" %}
